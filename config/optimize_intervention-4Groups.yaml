# Optimization Target List
# Strategy: "Unlock & Expand"
# Total Dimensions: 83
#   - Group A (Proven): High impact in previous run (|m| > 0.8)
#   - Group B (Axis): Neuron 2058 across layers 14-30 (The "Super-Neuron")
#   - Group C (Recovered): Top SVM candidates not yet fully tested
#   - Group D (New): Additional high-ranking SVM candidates
optimization:
  target_neurons:
    # --- Group A: Proven Winners (|m| > 0.8) ---
    - "layer_15-neuron_1215"
    - "layer_18-neuron_3629"
    - "layer_16-neuron_2807"
    - "layer_12-neuron_3994"
    - "layer_14-neuron_1829"
    - "layer_15-neuron_2895"
    - "layer_23-neuron_1990"
    - "layer_15-neuron_1659"
    - "layer_13-neuron_588"
    - "layer_16-neuron_122"
    - "layer_15-neuron_2470"
    - "layer_20-neuron_2212"
    - "layer_21-neuron_2212"
    - "layer_13-neuron_39"
    - "layer_14-neuron_3796"
    - "layer_16-neuron_2471"
    
    # --- Group B: The "2058" Axis (Layers 14-30) ---
    # Note: Some 2058s were also in Group A, listed here for completeness of the axis
    - "layer_14-neuron_2058"
    - "layer_15-neuron_2058"
    - "layer_16-neuron_2058"
    - "layer_17-neuron_2058"
    - "layer_18-neuron_2058"
    - "layer_19-neuron_2058"
    - "layer_20-neuron_2058" # High impact in prev run
    - "layer_21-neuron_2058"
    - "layer_22-neuron_2058" # High impact in prev run
    - "layer_23-neuron_2058"
    - "layer_24-neuron_2058" # High impact in prev run
    - "layer_25-neuron_2058" # High impact in prev run
    - "layer_26-neuron_2058" # High impact in prev run
    - "layer_27-neuron_2058"
    - "layer_28-neuron_2058"
    - "layer_29-neuron_2058"
    - "layer_30-neuron_2058"

    # --- Group C: Recovered (0.5 < |m| < 0.8) ---
    # These had decent signal and deserve a second chance in the wider range
    - "layer_15-neuron_1829"
    - "layer_14-neuron_805"
    - "layer_15-neuron_1886"
    - "layer_15-neuron_41"
    - "layer_13-neuron_1611"
    - "layer_13-neuron_3564"
    - "layer_18-neuron_2212"
    - "layer_13-neuron_3819"

    # --- Group D: New Candidates (Top SVM Ranks) ---
    - "layer_16-neuron_2145"
    - "layer_30-neuron_341"
    - "layer_10-neuron_3366"
    - "layer_10-neuron_3086"
    - "layer_13-neuron_977"
    - "layer_20-neuron_3356"
    - "layer_13-neuron_1913"
    - "layer_30-neuron_231"
    - "layer_10-neuron_4018"
    - "layer_21-neuron_3491"
    - "layer_29-neuron_3398"
    - "layer_21-neuron_2706"
    - "layer_15-neuron_940"
    - "layer_22-neuron_1455"
    - "layer_18-neuron_2836"
    - "layer_29-neuron_3685"
    - "layer_28-neuron_792"
    - "layer_17-neuron_77"
    - "layer_9-neuron_3366"
    - "layer_12-neuron_2815"
    - "layer_13-neuron_1722"
    - "layer_12-neuron_2699"
    - "layer_16-neuron_973"
    - "layer_31-neuron_231"
    - "layer_14-neuron_297"
    - "layer_22-neuron_1047"
    - "layer_14-neuron_1553"
    - "layer_16-neuron_77"
    - "layer_24-neuron_1455"
    - "layer_31-neuron_341"
    - "layer_24-neuron_2406"
    - "layer_18-neuron_2788"
    - "layer_23-neuron_1455"
    - "layer_18-neuron_4007"
    - "layer_11-neuron_3466"
    - "layer_22-neuron_2057"
    - "layer_19-neuron_1485"
    - "layer_16-neuron_1047"
    - "layer_14-neuron_2895"
    - "layer_31-neuron_2058"
    - "layer_13-neuron_2815"
    - "layer_19-neuron_3307"
  
  bounds: [-6.0, 6.0]
  
  # Sampler: "tpe" (Tree-structured Parzen Estimator) or "cmaes" (Covariance Matrix Adaptation Evolution Strategy)
  sampler: "cmaes"

  n_startup_trials: 100
  n_trials: 1000
  # Objective mode: "signed" returns raw signed soft PI, "absolute" returns abs(soft PI)
  # "signed" preserves polarization direction; "absolute" maximizes polarization magnitude
  objective_mode: "absolute"

  # Optimization direction: "maximize" or "minimize"
  # e.g. maximize signed → right-wing shift; minimize signed → left-wing shift
  # e.g. maximize absolute → max polarization regardless of direction
  direction: "maximize"

  # Study name for tracking/resuming
  study_name: "pi_maximization-4Groups-soft-abs-cmaes"
  
  # SQLite storage for resumability (relative to workspace)
  # Set to null for in-memory (non-resumable)
  storage: "sqlite:///runs/optuna_persist/pi_optimization.db"
  
  load_if_exists: true
  
  fast_mode: false
  fast_n_pairs: 10

# Likert test configuration
likert:
  questions_csv: "likert/questions_anderson.csv"
  language: "pt"
  max_new_tokens: 10
  temperature: 0.0

# Model/extraction settings
extraction:
  device: "cuda"

# Random seed for reproducibility
random_state: 42

# Hydra configuration
hydra:
  run:
    dir: runs/${now:%Y-%m-%d}/optimize_${now:%H-%M-%S}
  job_logging:
    version: 1
    formatters:
      simple:
        format: '[%(levelname)s] - %(message)s'
    handlers:
      console:
        class: logging.StreamHandler
        formatter: simple
        stream: ext://sys.stdout
      file:
        class: logging.FileHandler
        formatter: simple
        filename: optimize_intervention.log
    root:
      level: INFO
      handlers: [console, file]
    disable_existing_loggers: false
